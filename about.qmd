---
title: "Text Analysis"
---
 
## Childhood Heroes: Percy Jackson vs Harry Potter

In this project, we will look at how the Percy Jackson series compares to the Harry Potter series. Both book series are beloved children's novels, possibly two of the top series for most children born after the year 2000. The Harry Potter series is about a boy who learns he is a wizard and covers seven years of school in as many books, telling an overarching story about friendship and defeating a dark wizard with the power of love. The Percy Jackson series is about a boy who learns he is half god and goes on quests over four years and five novels to protect his friends and defeat the returning enemy of the gods. Both are full of magic and whimsy in addition to death and despair, but which may be better or more fun to read?

```{r, echo = FALSE, warning=FALSE, message = FALSE}
#libraries needed
library(tidyverse)
library(tidytext)
library(textdata)
library(ggthemes)
library(RCurl)

#read in data - percy jackson series
pjo_one <- read_csv("https://github.com/jbat22/SDS264_F25/raw/refs/heads/main/MiniProject1/pjo_book_one.csv")
pjo_two <- read_csv("https://github.com/jbat22/SDS264_F25/raw/refs/heads/main/MiniProject1/pjo_book_two.csv")
pjo_three <- read_csv("https://github.com/jbat22/SDS264_F25/raw/refs/heads/main/MiniProject1/pjo_book_three.csv")
pjo_four <- read_csv("https://github.com/jbat22/SDS264_F25/raw/refs/heads/main/MiniProject1/pjo_book_four.csv")
pjo_five <- read_csv("https://github.com/jbat22/SDS264_F25/raw/refs/heads/main/MiniProject1/pjo_book_five.csv")

#make each book into just one word per line (tokenize)
int_one <- pjo_one |>
  mutate(line = row_number(),
         book = "Lightning Thief",
         num = 1) |>
  unnest_tokens(word, `Percy Jackson 1 - The Lightning Thief`, token = "words")
int_two <- pjo_two |>
  mutate(line = row_number(),
         book = "Sea of Monsters",
         num = 2) |>
  unnest_tokens(word, Contents, token = "words")
int_three <- pjo_three |>
  mutate(line = row_number(),
         book = "Titan's Curse",
         num = 3) |>
  unnest_tokens(word,`THE TITAN'S CURSE`, token = "words")
int_four <- pjo_four |>
  mutate(line = row_number(),
         book = "Battle of the Labyrinth",
         num = 4) |>
  unnest_tokens(word, CONTENTS, token = "words")
int_five <- pjo_five |>
  mutate(line = row_number(),
         book = "Last Olympian",
         num = 5) |>
  unnest_tokens(word, `Table of Contents`, token = "words")
#combine percy jackson books into one tidy dataset
tidy_pjo <- rbind(int_one, int_two, int_three, int_four, int_five) |>
  mutate(book = fct_reorder(book, num)) #make books in correct order

pjo_characters <- c("percy", "annabeth", "grover", "chiron", "sally", "luke", "tyson", "thalia", "clarisse", "dionysus", "mr. d", "zeus", "athena", "poseidon", "artemis", "nico", "bianca", "zoe", "hades", "mrs. dodds", "medusa", "silena", "rachel", "chronos", "kronos", "jackson", "hermes") #list of most percy jackson characters (by memory)

#read in harry potter dataset 
potter_untidy <- read_csv(
  file = getURL("https://raw.githubusercontent.com/proback/264_fall_2025/refs/heads/main/Data/potter_untidy.csv", .encoding = "UTF-8")) |>
  mutate(title = fct_reorder(title, book_num)) #make books in correct order

potter_tidy <- potter_untidy |>
  unnest_tokens(output = word, input = text) #tokenize harry potter dataset

#create dataset of stopwords
smart_stopwords <- get_stopwords(source = "smart")

#get sentiments dataset 
bing_sentiments <- get_sentiments(lexicon = "bing")

#get list of harry potter spells
potter_spells <- read_csv(
  file = getURL("https://raw.githubusercontent.com/proback/264_fall_2025/refs/heads/main/Data/potter_spells.csv", .encoding = "UTF-8")) |>
  filter(spell_name != "Point Me")

#create list of weapons that may be used in percy jackson series
pjo_weapons <- c("sword", "bow", "axe", "spear", "dagger", "knife", "javelin", "scythe", "hairbrush", "hammer", "gun")
```

First, a concerned parent who is looking for a particularly intellectual child may ask which series is more sophisticated? Which series is going to teach their child to say big words and grow up faster? We can test this by seeing which of the series uses these Big Words, which we can do by seeing what the average word length is in each book. 

```{r, warning=FALSE}
tidy_pjo |>
  mutate(word_length = str_length(word)) |> 
  summarise(avg_length = mean(word_length))

potter_tidy |>
  mutate(word_length = str_length(word)) |>
  summarise(avg_length = mean(word_length))
```

It appears that the average word length in the Percy Jackson series is 4.24 letters, and in the Harry Potter series the average word length is 4.45 letters. Thus, maybe the Harry Potter series is going to make your child much much smarter due to that 0.21 extra letters on average. Or, perhaps this is just due to the pretentiousness of the British, who like to throw in extra u's into perfectly respectable words like "color" and "favourite". 

Other concerned parents may shrink away from both series due to their inherent "Un-Christian" nature of being about the Greek gods or witchcraft, respectively (yes, this is a thing that led to Harry Potter being banned in the past, as well as at least one person attempting to rewrite the Harry Potter series to be more Christian). We can look at which series should really be considered the most blasphemous - who is discussing "god" the most, and in what way?

```{r, warning=FALSE}
tidy_pjo |>
  mutate(god = str_detect(word, "god")) |> 
  filter(god == TRUE) |>
  count(word, sort = TRUE) 

potter_tidy |>
  mutate(god = str_detect(word, "god")) |>
  filter(god == TRUE) |>
  count(word, sort = TRUE) 
```

As one may expect, in the Percy Jackson series there is a lot more use of the word "god" in various context, including demigods, godlings, goddesses, god, and gods. Gods likely makes the top of the list due to the fact that almost every character says things like "Gods dammit" instead of "God dammit", because you may as well curse all of them at once. In Harry Potter, however, there is little discussion of god and gods, and indeed one of the few hints at any religion in the series is the fact that they all celebrate Christmas without any mention of any kind of worship (although many non-Christians celebrate Christmas nowadays). Another hint is that they discuss Harry having a godfather, Sirius Black, so you can definitely see the author's Christian background. However, the most popular use of the word "god" is actually in the name Godric, the founder of one of the school houses that the main character is in. This house is supposed to be all about bravery and courage, but which book actually talks about bravery more? 

```{r, warning=FALSE}
tidy_pjo |>
  mutate(brave = str_detect(word, "brave")) |> 
  filter(brave == TRUE) |>
  count(word, sort = TRUE) 

potter_tidy |>
  mutate(brave = str_detect(word, "brave")) |>
  filter(brave == TRUE) |>
  count(word, sort = TRUE) 
```

As expected, Harry Potter stresses the importance of bravery more than the Percy Jackson series - the fact that it is the entire theme of Harry's school house apparently overshadows the heroic themes of the Percy Jackson series.

In the same vein, what kinds of themes are most prevalent in these series? Most people expect that children's books should be full of whimsy and wonder, without straying into dark and depressing territory. However, it is also good to have these books cover more series topics on occasion, in order to introduce them to children in a more safe and welcoming environment. We can make some plots to see how the sentiments in the two series trend over their respective 5 and 7 book lengths. 

```{r, warning=FALSE}
tidy_pjo |>
  inner_join(bing_sentiments) |> 
  count(book, index = line %/% 80, sentiment) |>
  pivot_wider(names_from = sentiment, values_from = n, values_fill = 0) |>
  mutate(sentiment = positive - negative) |>
  ggplot(aes(x = index, y = sentiment, fill = book)) +
    geom_col(show.legend = FALSE) +
    facet_wrap(~book, ncol = 2, scales = "free_x")

potter_tidy |>
  inner_join(bing_sentiments) |>
  count(title, chapter, sentiment) |>
  pivot_wider(names_from = sentiment, values_from = n, values_fill = 0) |>
  mutate(sentiment = positive - negative) |>
  ggplot(aes(x = chapter, y = sentiment, fill = title)) +
    geom_col(show.legend = FALSE) +
    facet_wrap(~title, ncol = 2, scales = "free_x")
```

Alt Text: This is a faceted column chart showing the average sentiment score across the seven Harry Potter novels, where each chapter is a bar and each book has its own plot. The chapter number is on the x-axis, ranging from 0 to 40, and the sentiment score is on the y-axis, ranging from -200 to 100. The vast majority of scores are negative, including almost the entirety of the Chamber of Secrets, Prisoner of Azkaban, Order of the Phoenix, and Deathly Hallows. The other novels, namely Sorcerer's Stone, Goblet of Fire, and Half-Blood Prince, are approximately one-third positive sentiments, but the majority is still on average negative sentiments. 

Overall, both books seem to be more depressing than originally thought. In hindsight, this may make sense, as books tend to be full of lots of challenges and only minor triumphs until the large success at the end, occasionally followed by a dramatic cliffhanger for the next book. We can see this quite well in the Percy Jackson series - many of the books only have a handful of positive sentiment chapters in the majority of the book, but almost all have a peak near the very end, and many (especially the second and third books) turn down right at the end, which sets up the next book nicely. We also see some of the most significant downturns and upturns right at the end of the final Percy Jackson book. The Harry Potter series, however, seems to be pretty negative all around. There are some peaks in books like the Half-Blood Prince and the Goblet of Fire, which may correspond in the latter case with Harry's victories in the Triwizard Tournament, but most of the other books have negative overall sentiment almost the entire way through. The final book, Deathly Hallows, has almost no positive outlooks, even at the very end when the great evil has been defeated. Thus, to keep the kids happy, Percy Jackson might be a better series. 


Speaking of defeating evil, how are all these children managing to go up against massive villains? In Harry Potter, they have the power of magic and wonder on their side, whereas in Percy Jackson they have to take it back to the good old days of swords and steel. Let's look at what the most popular choices are for the children's weapons and tools in these series. 

First, we can see which spells in Harry Potter are most commonly used. 

```{r, warning=FALSE}
potter_tidy |>
  left_join(potter_spells, join_by(word == first_word)) |>
  filter(!is.na(spell)) |>
  count(spell_name, sort = TRUE)
```

The most common spell appears to be Expecto Patronum, which represents all the goodness and joy in one's heart and is also used to both stand against one's greatest fears and to conveniently send messages as needed. We then get a fun sprinkling of utility spells like Accio to summon things and Lumos to get a flashlight as well as all the combative spells like Expelliarmus (get rid of your opponent's wand), Stupefy (stun someone to keep them out of battle), Avada Kedavra (murder) and Crucio (terrible torture). Fun times in the Harry Potter series! Another interesting exploration of this is seeing what things people are summoning with the second most used spell, Accio.  

```{r, echo = FALSE, warning=FALSE}
#create list of bigrams in harry potter
tidy_ngram_potter <- potter_untidy |>
  unnest_tokens(bigram, text, token = "ngrams", n = 2) |> #text analysis application #2!!
  filter(bigram != "NA")
```


```{r, warning=FALSE}
str_subset(tidy_ngram_potter$bigram, "^accio .*$") 
```

From this list, it looks like people are using accio to summon all sorts of things, including a dictionary, broomsticks, cloaks, and other fun things like swords and salmon. There is also one case of summoning a brain, which if I remember correctly is in the end of the fifth novel when there is this strange brain with tentacles in a tank that attacks some of the characters. Either way, that one is a bit concerning. Moving on to what may or may not be a more concerning topic - what weapons do the characters of the Percy Jackson series prefer?

```{r, echo = FALSE, warning=FALSE}
tidy_pjo |>
  filter(word %in% pjo_weapons) |>
  count(word, sort = TRUE)
```

Swords are the most popular choice by far! This makes sense, as both the main character and the main villain use one, whereas spears are only really used by a couple of minor characters. The most important weapon, however, is only used as needed and thus makes its appearance the least - the hairbrush, which is used by one of the only normal mortal human characters in series to hit the main villain right in the eye as a wonderful distraction. 

Overall, we can see that both the Harry Potter and Percy Jackson series are unique in their own right, and both certainly have value from both a child's and parent's perspective. They've definitely earned their place on the shelves of libraries, homes, and bookstores across the world. 